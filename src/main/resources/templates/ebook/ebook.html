<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ebook</title>
	<!-- 폰트 설정 -->

	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&display=swap" rel="stylesheet">
	<!-- 아이콘 관련 -->
	<link class="material-symbols-outlined" rel="stylesheet"
		  href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"/>
	<!-- 제이쿼리 설정 -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
			integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
			crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<!-- 기기별 감지 -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/mobile-detect/1.4.5/mobile-detect.min.js"></script>
	<!-- ebook 관련 라이브러리 -->
	<script src="/js/lib/turn.min.js"></script>
	<script src="/js/init.js"></script>
	<script src="/js/function.js"></script>
	<!-- css -->
	<link rel="stylesheet" type="text/css" href="/css/common.css"/>
</head>
<style>
	body {
		width: 100vw;
		height: 100vh;
		background:#ccc;
		overflow: hidden;
	}

	.wrap {
		width: calc((100vh/1.414)*2);
		/*width: calc((100vw/2.1/1.414)*2);*/
		height: 100vh;
		margin: 0 auto;
		position: relative;
	}

	#book {
		width:100%;
		height: 100%;
		background-color: white;
	}

	#book .turn-page {
		background-color: #FFF;
	}

	#book .cover {
		background:#333;
	}

	#book .cover h1 {
		color:white;
		text-align:center;
		font-size:50px;
		line-height:500px;
		margin:0px;
	}

	#book .loader {
		background-image:url(/loader.gif);
		width:24px;
		height:24px;
		display:block;
		position:absolute;
		top:238px;
		left:188px;
	}

	#controls {
		display: flex;
		justify-content: space-between;
		position: relative;
		width:100% !important;
		height: 30px;
		text-align:center;
		margin:20px 0px;
		top: -9%;
	}

	.page-navi {
		width: 100%;
	}

	#page-number {
		display: inline-block;
		text-align: right;
		width: 40px;
		height: fit-content;
		padding: 0 5px;
		box-sizing: border-box;
		background: transparent;
		border: none;
	}

	#book img {
		width: 100%;
		height: 100%;
	}
	.page-number {
	}
	.number-pages {
		color: #999999;
	}

	.toc-wrap {
		border-top: solid 1px #000;
		width: 100%;
		height: 70px;
		position: absolute;
		bottom: 0;
		z-index: 9999999999999;
		opacity: 0;
		transition: 0.5s;
		background-color: #FFFFFF;
		padding: 0 30px;
		box-sizing: border-box;
	}

	#toc-page-navi {
		position: absolute;
		top: 50%;
		left: 46%;
		width: 80px;
		text-align: center;
		transform: translate(0, -50%);
	}

	#toc-number-pages {
		color: #999999;
	}

	.toc-wrap .toc-icon {
		position: absolute;
		top: 50%;
		right: 0;
		width: 24px;
		height: 24px;
		box-sizing: border-box;
		transform: translate(0, -50%);
		margin-right: 33px;
	}

	.toc-wrap:hover {
		/* 서서히 나타나는 효과 */
		visibility: visible;
		opacity: 1;
	}

	.wrap .toc-container {
		display: flex;
		width: calc((100vh/1.414)*2);
		height: 100vh;
		box-sizing: border-box;
		padding: 10px 0;
		background-color: #ffffff;
		z-index: 9999999999999;
		position: fixed;
		bottom: 0;
		/* 서서히 나타나는 효과 */
		visibility: hidden;
		opacity: 0;
		transition: 0.5s;
	}

	.wrap .toc-container.active {
		/* 서서히 나타나는 효과 */
		visibility: visible;
		opacity: 1;
	}

	.wrap #toc-action-sheet {
		width: 100%;
		max-height: 100vh;
		/* 아래에서 위로 나타나는 효과, max-height과 동일하게 작성 */
		position: relative;
		bottom: -100vh;
		transition: 0.5s;
	}

	.wrap .toc-container.active #toc-action-sheet {
		/* 아래에서 위로 나타나는 효과, max-height과 동일하게 작성 */
		bottom: 0;
	}

	.wrap .toc-container h2 {
		margin: 0;
		text-align: center;
	}

	.wrap .toc-container .close-icon {
		margin: 15px 17px;
		position: absolute;
		top: 0;
		right: 0;
	}

	.wrap .toc-li {
		display: flex;
		justify-content: space-between;
		width: 100%;
		border-top: 1px solid #ccc;
		padding: 10px 20px;
		box-sizing: border-box;
		font-weight: 700;
	}
</style>
<script th:inline="javascript">
	let g_ebookImageInfo = /*[[${ebookImageInfo}]]*/ 0;
	let pageMode;	//single or double
	//로딩 될 때
	$(function () {
		//기기별 ebook 출력
		printEbook();

		//목차 리스트 관련 이벤트 초기화
		tocEventInit();

		//윈도우 크기 변경 시 이벤트 (태블릿 회전 시 이벤트)
		$(window).on('resize', debounce(function() {
			pageMode = checkOrientation();
			alert(pageMode);
		}, 300)); // 300ms 후에 실행 (0.3초)
	});

	// 디바운스 함수
	function debounce(func, wait) {
		let timeout;
		return function() {
			clearTimeout(timeout);
			timeout = setTimeout(func, wait);
		};
	}

	//태블릿 orientation 체크
	function checkOrientation() {
		console.log(screen.height+','+screen.width);
		if (screen.height > screen.width) {
			//세로 길게
			return 'single';
		} else {
			//가로 길게
			return 'double';
		}
	}
	function fn_callback(callbackId, resData) {
	}

	function printEbook() {
		if(checkOrientation()==='single') {
			printSingleBook();
		}
		else if(checkOrientation()==='double') {
			printDoubleBook();
		}
	}

	//키보드 화살표 페이지 이동 이벤트
	$(window).bind('keydown', function (e) {
		if (e.target && e.target.tagName.toLowerCase() != 'input') {
			if (e.keyCode == 37)
				$('#book').turn('previous');
			else if (e.keyCode == 39)
				$('#book').turn('next');
		}
	});

	// 책 페이지 넘기기 이벤트
	function turnBook(oddOrEven){
		if(oddOrEven === 'odd'){
			$('#book').turn('previous');
		}
		else if(oddOrEven === 'even'){
			$('#book').turn('next');
		}
		else{}
	}


</script>
<body>
<!-- 데스크톱, 노트북, 태블릿 영역 -->
<div class="wrap">
	<div id="book">
		<!--<div class="cover"><h1>The Bible</h1></div>-->
	</div>
	<div class="toc-wrap">
		<div id="toc-page-navi">
			<span id="toc-page-number"></span> /
			<span id="toc-number-pages"></span>
		</div>
		<div class="toc-icon" onclick="openToc()">
			<span class="material-symbols-outlined" style="font-size:24px;">list_alt</span>
		</div>
	</div>
	<div class="toc-container">
		<div id="toc-action-sheet">
			<div class="close-icon" onclick="closeToc()"><span class="material-symbols-outlined">close</span></div>
			<h2>목차</h2>
			<ul>
				<li class="toc-li" value="1">일러스트<span>1p</span></li>
				<li class="toc-li" value="2">처음으로<span>2p</span></li>
				<li class="toc-li" value="3">크레딧<span>3p</span></li>
				<li class="toc-li" value="4">본문<span>4p</span></li>
				<li class="toc-li" value="26">저자 소개<span>26p</span></li>
				<li class="toc-li" value="27">공연 정보<span>27p</span></li>
			</ul>
		</div>
	</div>
</div>
</body>
</html>